<!doctype html>
<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-17P7VBGTPH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-17P7VBGTPH');
</script>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sam — Projects</title>
<style>
  :root{
    --bg-1:#020617;
    --bg-2:#06122a;
    --neon-1:#00e5ff;
    --neon-2:#0f6fff;
    --muted:#9aa7b6;
  }
  html, body {
    margin: 0; padding: 0; height: 100%;
    font-family: Inter, sans-serif;
    background: linear-gradient(180deg, var(--bg-1), var(--bg-2));
    color: white;
    overflow-x: hidden;
  }
  body.modal-open {
    overflow: hidden;
  }

  /* NAVBAR */
  nav.tabs {
    position: fixed;
    top: 1rem;
    right: 2rem;
    display: flex;
    gap: 1.5rem;
    z-index: 100;
  }
  nav.tabs a {
    color: var(--neon-1);
    text-decoration: none;
    font-weight: 600;
    font-size: 1rem;
    padding: 0.3rem 0.6rem;
    border-radius: 6px;
    border: 1.5px solid var(--neon-1);
    transition: background 0.3s, color 0.3s;
  }
  nav.tabs a:hover,
  nav.tabs a:focus {
    background: var(--neon-1);
    color: #04122a;
    box-shadow: 0 0 10px var(--neon-1);
    outline: none;
  }
  nav.tabs a.active {
    background: var(--neon-1);
    color: #04122a;
  }

  .hamburger {
    display: none;
    position: fixed;
    top: 1rem;
    right: 2rem;
    width: 30px;
    height: 22px;
    cursor: pointer;
    z-index: 110;
    flex-direction: column;
    justify-content: space-between;
  }
  .hamburger span {
    display: block;
    height: 4px;
    background: var(--neon-1);
    border-radius: 2px;
  }

  .sidebar {
    position: fixed;
    top: 0;
    right: 0;
    width: 250px;
    height: 100vh;
    background: var(--bg-2);
    padding: 3rem 1rem 1rem 1rem;
    display: none;
    flex-direction: column;
    gap: 1rem;
    z-index: 105;
  }
  .sidebar.show {
    display: flex;
  }
  .sidebar a {
    color: var(--neon-1);
    text-decoration: none;
    font-weight: 600;
    padding: 0.5rem 0.9rem;
    border-radius: 6px;
    border: 1.5px solid var(--neon-1);
    transition: background 0.3s, color 0.3s;
  }
  .sidebar a:hover,
  .sidebar a:focus {
    background: var(--neon-1);
    color: #04122a;
    outline: none;
  }
  .sidebar a.active {
    background: var(--neon-1);
    color: #04122a;
  }

  /* MAIN */
  main#projects-main {
    position: relative;
    min-height: 100vh;
    padding: 6rem 1rem 4rem;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }

  .page-toggle {
    position: absolute;
    top: 4.5rem; /* just below navbar */
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    border: 2px solid var(--neon-1);
    border-radius: 8px;
    overflow: hidden;
    z-index: 5;
  }

  .page-toggle .toggle-btn {
    padding: 0.5rem 1.2rem;
    background: transparent;
    color: var(--neon-1);
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .page-toggle .toggle-btn:hover {
    background: rgba(0, 229, 255, 0.15);
  }

  .page-toggle .toggle-btn.active {
    background: var(--neon-1);
    color: var(--bg-2);
  }

  /* Deck container */
  .deck-wrap {
    width: min(1200px, 95%);
    max-width: 1100px;
    height: 560px;
    position: relative;
    perspective: 1500px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2;
  }

  /* Center dotted line behind deck (subtle) */
  .belt-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 4px;
    background-image: radial-gradient(var(--neon-1) 3px, transparent 3px);
    background-size: 16px 4px;
    transform: translateY(-50%);
    z-index: 0;
    opacity: 0.06;
  }

  /* Card styles */
  .deck {
    width: 540px;
    height: 380px;
    position: relative;
    transform-style: preserve-3d;
    touch-action: pan-y;
  }

  .card {
    --offsetY: 0px;
    position: absolute;
    left: 50%;
    top: 50%;
    width: 440px;
    max-width: 88%;
    height: 300px;
    transform: translate(-50%, -50%) translateY(var(--offsetY)) scale(1) rotateZ(0deg);
    background: linear-gradient(180deg, rgba(6,18,42,0.95), rgba(2,6,23,0.95));
    border-radius: 14px;
    border: 1px solid rgba(0,229,255,0.12);
    box-shadow: 0 10px 40px rgba(0,0,0,0.6), 0 0 18px rgba(15,111,255,0.06);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 1.2rem;
    text-align: center;
    color: white;
    font-weight: 700;
    user-select: none;
    cursor: grab;
    transition: transform 300ms cubic-bezier(.2,.9,.3,1), box-shadow 200ms ease, opacity 200ms ease;
    will-change: transform, opacity;
    z-index: 1;
    background: linear-gradient(135deg, #0a1f44, #021026); /* deep blue gradient */
  border-radius: 16px;
  border: 2px solid rgba(115, 164, 206, 0.642); /* brighter, semi-transparent cyan edge */
  box-shadow:
    0 20px 60px rgba(32, 124, 181, 0.514),
    0 0 30px rgba(61, 113, 192, 0.2); /* slightly stronger glow for edges */
  }

  .card:active { cursor: grabbing; }

  .card h3 {
    margin: 0 0 0.4rem;
    font-size: 1.25rem;
    line-height: 1.1;
  }
  .card p {
    margin: 0;
    font-size: 0.95rem;
    color: var(--neon-1);
    opacity: 0.9;
    line-height: 1.1;
    font-weight: 600;
  }

  /* small project meta at bottom */
  .card .meta {
    position: absolute;
    bottom: 14px;
    left: 18px;
    right: 18px;
    text-align: left;
    font-size: 0.82rem;
    color: var(--muted);
    font-weight: 500;
  }

  /* top card elevation */
  .card.top {
    box-shadow: 0 20px 60px rgba(0,0,0,0.7), 0 0 30px rgba(8, 106, 253, 0.12);
    cursor: grab;
    box-shadow:
    0 25px 70px rgba(0,0,0,0.75),
    0 0 35px rgba(15,111,255,0.35),
    0 0 8px rgba(0,229,255,0.5) inset; /* soft cyan inset glow around edges */
  }
.card:not(.top) {
  box-shadow: 0 8px 20px rgba(0,0,0,0.45), 0 0 12px rgba(0,111,255,0.05);
}


  /* offscreen animation helpers */
  .fly-left { transition: transform 450ms cubic-bezier(.08,.7,.35,1), opacity 350ms ease; transform: translate(-150vw, -20vh) rotateZ(-25deg) scale(0.95); opacity: 0; }
  .fly-right { transition: transform 450ms cubic-bezier(.08,.7,.35,1), opacity 350ms ease; transform: translate(150vw, -10vh) rotateZ(25deg) scale(0.95); opacity: 0; }
  .fly-up { transition: transform 450ms cubic-bezier(.08,.7,.35,1), opacity 350ms ease; transform: translate(-5vw, -150vh) rotateZ(-6deg) scale(0.95); opacity: 0; }

  

  /* small hint */
  .deck-hint {
    position: absolute;
    bottom: -40px;
    left: 50%;
    transform: translateX(-50%);
    color: var(--muted);
    font-size: 0.9rem;
    z-index: 4;
  }

  /* RESPONSIVE */
  @media(max-width:900px) {
    nav.tabs { display: none; }
    .hamburger { display: flex; }
    main#projects-main {
      padding: 5rem 1rem 4rem;
    }
    .deck-wrap { height: 480px; }
    .deck { width: 90%; height: 320px; }
    .card { width: 90%; height: 260px; }
    .deck-hint { bottom: -46px; font-size: 0.9rem; }
  }

  @media(max-width:480px) {
    .deck-wrap { height: 420px; }
    .deck { height: 300px; }
    .card { height: 240px; }
    .page-toggle { top: 5.2rem; }
  }

  /* Modal / other styles kept unchanged */
  .modal {
    position: fixed;
    top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(2,6,23,0.9);
    backdrop-filter: blur(5px);
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }
  .modal.show {
    opacity: 1;
    visibility: visible;
  }
  .modal-content {
    background: var(--bg-2);
    border: 1px solid var(--neon-2);
    box-shadow: 0 0 30px rgba(15,111,255,0.3);
    border-radius: 16px;
    max-width: 800px;
    width: 90vw;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    position: relative;
    overflow: hidden;
  }
  .close-modal {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: none;
    border: none;
    font-size: 2rem;
    color: var(--muted);
    cursor: pointer;
    line-height: 1;
    transition: color 0.3s ease;
    z-index: 10;
  }
  .close-modal:hover,
  .close-modal:focus {
    color: white;
    outline: none;
  }
  .modal-body {
    padding: 2rem;
    overflow-y: auto;
    color: var(--muted);
  }
  .modal-body img {
    width: 100%;
    max-height: 550px;
    object-fit: cover;
    border-radius: 8px;
    margin-bottom: 1.5rem;
    background-color: var(--bg-1);
  }
  .modal-body h2 {
    font-size: clamp(1.5rem, 4vw, 2.25rem);
    background: linear-gradient(90deg, var(--neon-2), var(--neon-1));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin: 0 0 1rem;
  }
  .modal-body p {
    line-height: 1.6;
    margin-bottom: 1.5rem;
  }
  .modal-github-link {
    display: inline-flex;
    align-items: center;
    gap: 0.6rem;
    padding: 0.6rem 1.2rem;
    border-radius: 10px;
    border: 1.5px solid var(--neon-1);
    background: none;
    text-decoration: none;
    color: var(--neon-1);
    font-weight: 700;
    transition: all 0.2s ease;
  }
  .modal-github-link:hover,
  .modal-github-link:focus {
    transform: translateY(-3px);
    box-shadow: 0 0 18px rgba(0,229,255,0.25);
    background: rgba(0,229,255,0.1);
    outline: none;
  }
  .icon-svg {
    width: 20px;
    height: 20px;
    fill: currentColor;
  }

  footer { text-align:center;padding:1.5rem 0;color:var(--muted);font-size:0.85rem; }

</style>
</head>
<body>

<nav class="tabs" aria-label="Main navigation">
  <a href="index.html">Home</a>
  <a href="skills.html">Skills</a>
  <a href="experience.html">Experience</a>
  <a href="projects.html" class="active">Projects</a>
  <!--<a href="pcbs.html">PCBs</a>-->
  <a href="about.html">About</a>
  <a href="resume.html">Resume</a>
  <a href="contact.html">Contact</a>
</nav>

<div class="hamburger" aria-label="Open navigation menu" role="button" tabindex="0" aria-expanded="false" aria-controls="mobile-menu">
  <span></span><span></span><span></span>
</div>

<nav id="mobile-menu" class="sidebar" aria-label="Mobile navigation" hidden>
  <a href="index.html">Home</a>
  <a href="skills.html">Skills</a>
  <a href="experience.html">Experience</a>
  <a href="projects.html" class="active">Projects</a>
  <!--<a href="pcbs.html">PCBs</a>-->
  <a href="about.html">About</a>
  <a href="resume.html">Resume</a>
  <a href="contact.html">Contact</a>
</nav>

<main id="projects-main" aria-label="Project list">

  <div class="page-toggle">
    <a href="projects.html" class="toggle-btn active">Hardware & Software</a>
    <a href="pcbs.html" class="toggle-btn">PCB Gallery</a>
  </div>

  <div class="belt-line" aria-hidden="true"></div>

  <div class="deck-wrap" aria-live="polite">
    <div class="deck" id="deck" role="list" aria-label="Projects deck">
      <!-- Single set of project nodes - data attributes remain for modal -->
      <div class="card" role="listitem" tabindex="0"
        data-title="INSITE Bioprinter Project"
        data-img="assets\INSITE.png"
        data-desc="Awarded the highly competitive First Year Summer Research Fellowship (1 of 15 selected from over 1,000 first-year engineering students), supervised by Professor Axel Guenther. Redesigning the INSITE handheld bioprinter to improve reliability and clinical usability. Enhancing motion control systems and firmware for greater printing precision and real-time responsiveness. Prototyping intuitive control interfaces and iterating designs with PhD mentors to enhance surgical experience.">
        <h3>INSITE Bioprinter</h3>
        <p>Summer Research Fellowship</p>
        <div class="meta">Click to Open. Swipe to view next.</div>
      </div>

      <div class="card" role="listitem" tabindex="0"
        data-title="ZenVision"
        data-img="assets\ZenVision Glasses.png"
        data-desc="ZenVision is a wearable smart glasses system designed to support children with ADHD who struggle with impulsive verbal outbursts in the classroom. Built for a 9-year-old child, Megan, introduced to us by our clients, the system discreetly detects when she speaks out loudly—often a response to anxiety—and gently delivers visual reminders on the lens to help with self-regulation, without singling her out. The system uses an ESP32 microcontroller and MAX4466 microphone to monitor sound in real-time. A custom CNN (built with TensorFlow and trained on MFCCs) confirms whether the voice is Megan’s before triggering the prompt—achieving an average response time of just 1.93 seconds. A companion web dashboard (HTML/CSS/JS + Plotly.js) logs these events to a real-time database, enabling teachers and parents to track behavioral patterns and progress over time. Selected as a Top 20 Project (out of 187 teams) in the UofT ESP (APS 112) Showcase."
        data-github="https://github.com/SemontiiMandal/ZenVision">
        <h3>ZenVision</h3>
        <p>ADHD Support Glasses</p>
        <div class="meta">Click to Open. Swipe to view next.</div>
      </div>

      <div class="card" role="listitem" tabindex="0"
        data-title="Auracle"
        data-img="assets\Auracle Glasses and Gloves.jpg"
        data-desc="Auracle is a wearable system that combines glasses and gloves for voice- and gesture-based music generation and control. The glasses are equipped with a voice recording module that captures user commands, which are then converted to text using Hugging Face’s speech-to-text model. This text prompt is passed to Hugging Face’s AudioLDM 2, a generative AI model, to create a unique music track tailored to the user’s request. Sentiment analysis is performed on the text prompt using TextBlob to determine the emotional tone, and this data is logged into Firebase’s Realtime Database and visualized on a Streamlit dashboard to track the user’s mood history. The gloves, equipped with accelerometer and gyroscope sensors, allow the user to control music functions such as skipping tracks, adjusting volume, and stopping the music through simple hand gestures. A full-stack application built with Streamlit manages user profiles, music generation history, and mood tracking."
        data-github="https://github.com/SemontiiMandal/Auracle">
        <h3>Auracle</h3>
        <p>Voice and Gesture-Controlled Music Generation System</p>
        <div class="meta">Click to Open. Swipe to view next.</div>
      </div>

      <div class="card" role="listitem" tabindex="0"
        data-title="Wildfire Response"
        data-img="assets\UTEK.jpg"
        data-desc="Developed an automated response system in Python to rescue citizens in distress during wildfires and manage communication between users and dispatch centers. Integrated Twilio and Google Sheets APIs (gspread) to collect user details—such as injury severity, age, and location—via SMS and store them in a centralized data repository. Designed a priority-based dispatch algorithm that deploys rescuers by assessing priority according to Canada’s Ministry of Health’s Triage and Acuity Scale (CTAS) guidelines, ensuring efficient and accurate resource allocation."
        data-github="https://github.com/SemontiiMandal/Automated-Emergency-Response-System-for-Wildfires">
        <h3>Wildfire Response</h3>
        <p>Automated Emergency Response System</p>
        <div class="meta">Click to Open. Swipe to view next.</div>
      </div>

      <div class="card" role="listitem" tabindex="0"
        data-title="Wearable Breathing Biofeedback Device"
        data-img="assets\ut_biome_logo.jpg"
        data-desc="We are collaborating with Prof. Christopher Bouwmeester (UofT IBME & ISTEP) to design a wearable biofeedback device that monitors real-time breathing patterns. The device aims to assist users in learning deep breathing techniques, such as diaphragmatic breathing. Using Machine Learning algorithms, it will analyze breathing patterns to detect potential diseases. The device incorporates an Arduino Nano, stretch sensors, FFT analysis, and buzzer feedback for real-time guidance and monitoring.">
        <h3>Breathing Biofeedback</h3>
        <p>UTBIOME (UofT Biomedical Engineering) Design Team</p>
        <div class="meta">Click to Open. Swipe to view next.</div>
      </div>

      <div class="card" role="listitem" tabindex="0"
        data-title="Kidney Stone Detection"
        data-img="assets\ks.png"
        data-desc="The Kidney Stone Detection System is a machine learning-based solution designed to predict kidney stones by analyzing the physical characteristics of urine. Using supervised learning classifiers, such as Logistic Regression, Decision Tree, and Support Vector Machine (SVM), the system detects potential abnormalities, offering a non-invasive and cost-effective alternative to imaging techniques like CT scans. Trained on a dataset of urine characteristics, the system achieved over 80% accuracy and an F1 score above 85%."
        data-github="https://github.com/SemontiiMandal/Research-Paper-Kidney-Stones-JEI">
        <h3>Kidney Stone Detection</h3>
        <p>Published ML Research</p>
        <div class="meta">Click to Open. Swipe to view next.</div>
      </div>

      <div class="card" role="listitem" tabindex="0"
        data-title="Plant Disease Detector"
        data-img="assets\leaves.jpeg"
        data-desc="The Plant Disease Detection project uses deep learning to identify plant diseases from images. It leverages the ResNet50 model, a pre-trained Convolutional Neural Network (CNN), fine-tuned to classify images into 38 categories of plant diseases. The model is trained on an augmented dataset, incorporating techniques like zoom, shift, and flipping to prevent overfitting. With Python, TensorFlow, and Keras, the project achieves over 96.5% classification accuracy."
        data-github="https://github.com/SemontiiMandal/Plant-Disease-Detection">
        <h3>Plant Disease Detecting Algorithm</h3>
        <p>Deep Learning / CNN</p>
        <div class="meta">Click to Open. Swipe to view next.</div>
      </div>

      <div class="card" role="listitem" tabindex="0"
        data-title="Malicious URL Detector"
        data-img="assets\cs.jpg"
        data-desc="The Malicious URL Detector is a machine learning project designed to classify URLs as either malicious or benign, enhancing cybersecurity. Using natural language processing (NLP) techniques, the model tokenizes URLs into features and applies algorithms like Logistic Regression and Support Vector Machines (SVM) for classification. The project utilizes Python and libraries such as Pandas, NumPy, and Scikit-learn for data manipulation, feature extraction, and model evaluation. By analyzing URL patterns, it aims to identify harmful links and strengthen online security."
        data-github="https://github.com/SemontiiMandal/Malicious-URL-Detector">
        <h3>Malicious URL Detector</h3>
        <p>NYAS Junior Academy Finalist</p>
        <div class="meta">Click to Open. Swipe to view next.</div>
      </div>

      <div class="card" role="listitem" tabindex="0"
        data-title="MNIST Digits"
        data-img="assets\MNIST_dataset_example.png"
        data-desc="The MNIST Handwritten Digits Recognition project uses deep learning to classify handwritten digits from the MNIST dataset. The model employs a neural network with dense layers and ReLU activation, trained using TensorFlow. It is designed to accurately recognize digits and can be extended for custom images. The network achieves 98.6% accuracy on the MNIST test set, with a three-layer architecture that includes flattening the input image, two hidden dense layers, and a final output layer with softmax activation."
        data-github="https://github.com/SemontiiMandal/MNIST-Classification">
        <h3>MNIST Digits</h3>
        <p>ML Classification</p>
        <div class="meta">Click to Open. Swipe to view next.</div>
      </div>

    </div>

    <!--<div class="deck-hint" aria-hidden="true">Click to Open. Swipe to move it to the bottom.</div>-->
  </div>
</main>

<!-- MODAL -->
<div id="project-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-describedby="modal-desc" hidden>
  <div class="modal-content">
    <button class="close-modal" aria-label="Close project details">&times;</button>
    <div class="modal-body">
      <img id="modal-img" src="" alt="" />
      <h2 id="modal-title"></h2>
      <p id="modal-desc"></p>
      <a id="modal-github" href="#" target="_blank" rel="noopener" class="modal-github-link" aria-label="View GitHub repository" style="display:none;">
        <svg class="icon-svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M12 .5C5.73.5.75 5.48.75 11.74c0 4.9 3.18 9.06 7.58 10.53.55.1.75-.24.75-.53 0-.26-.01-1.13-.02-2.05-3.08.67-3.73-1.49-3.73-1.49-.5-1.28-1.22-1.62-1.22-1.62-.99-.68.08-.67.08-.67 1.1.08 1.68 1.13 1.68 1.13.97 1.66 2.55 1.18 3.17.9.1-.7.38-1.18.69-1.45-2.46-.28-5.05-1.23-5.05-5.47 0-1.21.43-2.2 1.13-2.98-.12-.28-.49-1.4.11-2.92 0 0 .92-.3 3.02 1.13.88-.25 1.82-.38 2.75-.38.93 0 1.87.13 2.75.38 2.1-1.43 3.02-1.13 3.02-1.13.6 1.52.23 2.64.11 2.92.7.78 1.13 1.77 1.13 2.98 0 4.24-2.6 5.19-5.07 5.46.39.34.73 1.02.73 2.06 0 1.49-.01 2.7-.01 3.07 0 .29.2.64.76.53C20.07 20.8 23.25 16.64 23.25 11.74 23.25 5.48 18.27.5 12 .5z"/>
        </svg>
        GitHub
      </a>
    </div>
  </div>
</div>

<footer>&copy; Sam — ECE @ UofT</footer>

<script>
  // Hamburger toggle (same behavior as other pages)
  const hamburger = document.querySelector('.hamburger');
  const sidebar = document.getElementById('mobile-menu');

  function toggleMenu(){
    const isOpen = sidebar.classList.toggle('show');
    if(isOpen) sidebar.removeAttribute('hidden'); else sidebar.setAttribute('hidden','');
    hamburger.setAttribute('aria-expanded', isOpen);
  }
  hamburger.addEventListener('click', toggleMenu);
  hamburger.addEventListener('keydown', (e) => {
    if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleMenu(); }
  });

  sidebar.querySelectorAll('a').forEach(a => a.addEventListener('click', () => {
    sidebar.classList.remove('show'); sidebar.setAttribute('hidden',''); hamburger.setAttribute('aria-expanded', false);
  }));

  // Modal functionality (unchanged logic)
  const modal = document.getElementById('project-modal');
  const modalTitle = modal.querySelector('#modal-title');
  const modalDesc = modal.querySelector('#modal-desc');
  const modalImg = modal.querySelector('#modal-img');
  const modalGitHub = modal.querySelector('#modal-github');
  const closeBtn = modal.querySelector('.close-modal');

  function openModalFromCard(node) {
    const title = node.getAttribute('data-title');
    const desc = node.getAttribute('data-desc');
    const img = node.getAttribute('data-img');
    const github = node.getAttribute('data-github');

    modalTitle.textContent = title;
    modalDesc.textContent = desc;
    modalImg.src = img;
    modalImg.alt = title + " screenshot";

    if(github) {
      modalGitHub.href = github;
      modalGitHub.style.display = 'inline-flex';
    } else {
      modalGitHub.style.display = 'none';
    }

    modal.hidden = false;
    modal.classList.add('show');
    document.body.classList.add('modal-open');
    closeBtn.focus();
  }

  closeBtn.addEventListener('click', closeModal);
  modal.addEventListener('click', e => {
    if (e.target === modal) closeModal();
  });
  window.addEventListener('keydown', e => {
    if(e.key === 'Escape' && !modal.hidden) {
      closeModal();
    }
  });
  function closeModal() {
    modal.classList.remove('show');
    modal.hidden = true;
    document.body.classList.remove('modal-open');
  }

  // Deck logic: stack cards visually and support swipe-to-bottom
(function(){
  const deck = document.getElementById('deck');
  let cards = Array.from(deck.querySelectorAll('.card'));
  let isPointerDown = false;
  let startX = 0, startY = 0;
  let currentCard = null;
  let dragId = null;
  let dragged = false;
  const SWIPE_THRESHOLD = 80; // pixels to trigger swipe
  const STACK_OFFSET_Y = 16; // px vertical offset per card
  const STACK_SCALE_STEP = 0.02; // scale reduction per depth
  const MAX_DEPTH_SHOW = 6; // how many cards to style (the rest hidden under)

  function renderStack(animated = true) {
    cards = Array.from(deck.querySelectorAll('.card'));
    cards.forEach((card, idx) => {
      const depth = idx;
      const capped = Math.min(depth, MAX_DEPTH_SHOW);
      const translateY = capped * STACK_OFFSET_Y;
      const scale = 1 - capped * STACK_SCALE_STEP;
      const rotate = (depth % 2 === 0) ? (capped * 0.4) : (-capped * 0.4);
      const zIndex = (cards.length - idx) + 100;
      card.style.zIndex = zIndex;
      card.style.setProperty('--offsetY', `${translateY}px`);
      card.classList.toggle('top', idx === 0);

      if(animated) {
        card.style.transition = 'transform 280ms cubic-bezier(.2,.9,.3,1), box-shadow 220ms ease, opacity 220ms ease';
      } else {
        card.style.transition = 'none';
      }

      card.style.transform = `translate(-50%, -50%) translateY(${translateY}px) scale(${scale}) rotateZ(${rotate}deg)`;
      card.style.opacity = (depth > 8) ? 0 : 1;
      card.style.pointerEvents = (idx === 0) ? 'auto' : 'none';
      // clear any lingering drag shadow on non-top cards
      if (idx !== 0) card.style.boxShadow = '';
    });
  }

  // Move top card to bottom of DOM order (robust)
function moveTopToBottom(direction = 'left') {
  if (cards.length === 0) return;
  const top = cards[0];

  // clear inline transforms from dragging
  top.style.transform = '';
  top.style.transition = '';
  void top.offsetWidth; // force reflow

  // animate out
  if (direction === 'left') top.classList.add('fly-left');
  else if (direction === 'right') top.classList.add('fly-right');
  else top.classList.add('fly-up');

  deck.style.pointerEvents = 'none';

  const finish = () => {
    top.removeEventListener('transitionend', finish);
    top.classList.remove('fly-left','fly-right','fly-up');
    top.style.transition = 'none';
    top.style.boxShadow = '';

    // temporarily hide the card while moving it
    top.style.visibility = 'hidden';

    // append to bottom
    deck.appendChild(top);

    // re-render, then fade it back in
    setTimeout(() => {
      renderStack(true);
      top.style.visibility = 'visible';
      deck.style.pointerEvents = 'auto';
    }, 25);
  };

  top.addEventListener('transitionend', finish);
  setTimeout(finish, 700); // fallback safety
}


  function bindCardEvents(card) {
    // avoid attaching multiple duplicates
    if (card.dataset.bound) return;
    card.dataset.bound = 'true';

    card.addEventListener('click', (e) => {
      if (dragged) { dragged = false; return; }
      openModalFromCard(card);
    });
    card.addEventListener('keydown', (e) => {
      if(e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        openModalFromCard(card);
      }
    });

    card.addEventListener('pointerdown', (e) => {
      // only top card draggable
      if (!card.classList.contains('top')) return;
      isPointerDown = true;
      dragged = false;
      currentCard = card;
      startX = e.clientX;
      startY = e.clientY;
      dragId = e.pointerId;
      try { card.setPointerCapture(dragId); } catch(_) {}
      // remove transition so we move it exactly with pointer
      card.style.transition = 'none';
    });

    card.addEventListener('pointermove', (e) => {
      if (!isPointerDown || e.pointerId !== dragId || !currentCard) return;
      const dx = e.clientX - startX;
      const dy = e.clientY - startY;
      const rotate = Math.max(-35, Math.min(35, dx * 0.12));
      currentCard.style.transform = `translate(-50%, -50%) translate(${dx}px, ${dy}px) rotateZ(${rotate}deg)`;
      currentCard.style.boxShadow = '0 30px 80px rgba(0,0,0,0.75), 0 0 40px rgba(15,111,255,0.18)';
      dragged = Math.abs(dx) > 6 || Math.abs(dy) > 6;
    });

    card.addEventListener('pointerup', (e) => {
      if (!currentCard || e.pointerId !== dragId) return;
      isPointerDown = false;
      try { currentCard.releasePointerCapture(dragId); } catch(_) {}
      const dx = e.clientX - startX;
      const dy = e.clientY - startY;

      if (Math.abs(dx) > SWIPE_THRESHOLD || Math.abs(dy) > SWIPE_THRESHOLD) {
        const dir = (Math.abs(dx) > Math.abs(dy)) ? (dx > 0 ? 'right' : 'left') : 'up';
        // clear the drag state on this card (so it's ready for CSS animation)
        // do NOT leave transition:none inlined — moveTopToBottom will clear it.
        moveTopToBottom(dir);
      } else {
        // return to stack
        currentCard.style.transition = 'transform 260ms cubic-bezier(.2,.9,.3,1), box-shadow 220ms ease';
        // clear box shadow and let renderStack snap it back
        currentCard.style.boxShadow = '';
        renderStack(true);
      }

      // reset pointer state
      setTimeout(()=> { dragged = false; }, 50);
      currentCard = null;
      dragId = null;
    });

    card.addEventListener('pointercancel', (e) => {
      if (!currentCard || e.pointerId !== dragId) return;
      isPointerDown = false;
      try { currentCard.releasePointerCapture(dragId); } catch(_) {}
      currentCard.style.boxShadow = '';
      renderStack(true);
      currentCard = null;
      dragId = null;
    });

    card.addEventListener('contextmenu', (e) => e.preventDefault());
  }

  function initDeck() {
    cards = Array.from(deck.querySelectorAll('.card'));
    cards.forEach((c) => bindCardEvents(c));
    renderStack(false);
  }

  window.addEventListener('keydown', (e) => {
    if (document.body.classList.contains('modal-open')) return;
    if (e.key === 'ArrowRight' || e.key === 'ArrowLeft' || e.key === ' ') {
      e.preventDefault();
      moveTopToBottom(e.key === 'ArrowRight' ? 'right' : 'left');
    }
  });

  initDeck();
  window.addEventListener('resize', () => renderStack(false));
})();


  // Accessibility: focus styles and trap no additional modifications required

</script>

</body>
</html>



