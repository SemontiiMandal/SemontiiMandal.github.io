<!DOCTYPE html>
<html lang="en">
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-17P7VBGTPH"></script>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sam — PCB Projects</title>

<!-- Import model-viewer web component for 3D .glb rendering -->
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
  :root {
    --bg-1: #020617;
    --bg-2: #06122a;
    --neon-1: #00e5ff;
    --neon-2: #0f6fff;
    --muted: #9aa7b6;
  }

  html, body {
    margin: 0; padding: 0; height: 100%;
    font-family: Inter, sans-serif;
    background: linear-gradient(180deg, var(--bg-1), var(--bg-2));
    color: white;
    overflow-x: hidden;
  }

  /* === NAV TABS (top-right) === */
  nav.tabs {
    position: fixed;
    top: 1rem;
    right: 2rem;
    display: flex;
    gap: 1.5rem;
    z-index: 100;
  }
  nav.tabs a {
    color: var(--neon-1);
    text-decoration: none;
    font-weight: 600;
    font-size: 1rem;
    padding: 0.3rem 0.6rem;
    border-radius: 6px;
    border: 1.5px solid var(--neon-1);
    user-select: none;
    transition: background 0.3s, color 0.3s, box-shadow 0.3s;
  }
  nav.tabs a:hover,
  nav.tabs a:focus {
    background: var(--neon-1);
    color: #04122a;
    box-shadow: 0 0 10px var(--neon-1);
    outline: none;
  }
  nav.tabs a.active {
    background: var(--neon-1);
    color: #04122a;
  }

  /* === HAMBURGER === */
  .hamburger {
    display: none;
    position: fixed;
    top: 1rem;
    right: 2rem;
    width: 30px;
    height: 22px;
    cursor: pointer;
    z-index: 110;
    flex-direction: column;
    justify-content: space-between;
  }
  .hamburger span {
    display: block;
    height: 4px;
    background: var(--neon-1);
    border-radius: 2px;
  }

  /* === SIDEBAR MOBILE MENU === */
  .sidebar {
    position: fixed;
    top: 0;
    right: 0;
    width: 250px;
    height: 100vh;
    background: var(--bg-2);
    padding: 3rem 1rem 1rem 1rem;
    display: none;
    flex-direction: column;
    gap: 1rem;
    z-index: 105;
    overflow-y: auto;
  }
  .sidebar.show {
    display: flex;
  }
  .sidebar a {
    color: var(--neon-1);
    text-decoration: none;
    font-weight: 600;
    padding: 0.5rem 0.9rem;
    border-radius: 6px;
    border: 1.5px solid var(--neon-1);
    user-select: none;
  }
  .sidebar a.active {
    background: var(--neon-1);
    color: #04122a;
  }
  .sidebar a:hover,
  .sidebar a:focus {
    background: var(--neon-1);
    color: #04122a;
    box-shadow: 0 0 10px var(--neon-1);
    outline: none;
  }

  /* === MAIN CONTENT === */
  main {
    max-width: 720px;
    margin: 8rem auto 4rem;
    padding: 2rem;
    background: rgba(0, 229, 255, 0.06);
    border-radius: 16px;
    box-shadow: 0 0 40px rgba(0, 229, 255, 0.08);
  }
  h1 {
    font-size: clamp(2rem, 5vw, 3rem);
    background: linear-gradient(90deg, var(--neon-2), var(--neon-1));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 1.25rem;
    text-align: center;
  }

  /* === PCB CARDS GRID === */
  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
  }

  /* === PCB CARD === */
  .pcb-card {
    background: var(--bg-2);
    border-radius: 12px;
    padding: 1rem;
    cursor: pointer;
    box-shadow: 0 0 15px rgba(0, 229, 255, 0.2);
    display: flex;
    flex-direction: column;
    transition: transform 0.3s ease;
    user-select: none;
  }
  .pcb-card:hover,
  .pcb-card:focus-visible {
    transform: translateY(-5px);
    outline: none;
    box-shadow: 0 0 20px var(--neon-1);
  }
  .pcb-card h3 {
    margin: 0 0 0.5rem;
    color: var(--neon-1);
  }
  .pcb-card p {
    flex-grow: 1;
    font-size: 0.9rem;
    opacity: 0.9;
  }
  .pcb-card img {
    width: 100%;
    border-radius: 8px;
    margin-top: 0.8rem;
    object-fit: cover;
    height: 140px;
    pointer-events: none;
    user-select: none;
  }

  .page-toggle {
    position: absolute;
    top: 4.5rem; /* just below navbar */
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    border: 2px solid var(--neon-1);
    border-radius: 8px;
    overflow: hidden;
    z-index: 5;
  }

  .page-toggle .toggle-btn {
    padding: 0.5rem 1.2rem;
    background: transparent;
    color: var(--neon-1);
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .page-toggle .toggle-btn:hover {
    background: rgba(0, 229, 255, 0.15);
  }

  .page-toggle .toggle-btn.active {
    background: var(--neon-1);
    color: var(--bg-2);
  }

  /* === MODAL OVERLAY === */
  #modalOverlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.85);
    z-index: 1500;
    align-items: center;
    justify-content: center;
    padding: 1rem;
  }
  #modalOverlay.show {
    display: flex;
  }
  #modalContent {
    background: var(--bg-2);
    border-radius: 12px;
    max-width: 900px;
    max-height: 90vh;
    width: 100%;
    color: white;
    display: flex;
    flex-direction: column;
    position: relative;
    box-shadow: 0 0 25px var(--neon-1);
    outline: none;
  }

  /* === MODAL HEADER === */
  #modalHeader {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem 0.5rem 1.5rem;
    border-bottom: 1.5px solid var(--neon-1);
  }
  #modalHeader h2 {
    margin: 0;
    font-weight: 700;
    font-size: 1.6rem;
    color: var(--neon-1);
  }
  #modalClose {
    background: transparent;
    border: none;
    font-size: 2rem;
    color: var(--neon-1);
    cursor: pointer;
    line-height: 1;
    user-select: none;
  }
  #modalClose:hover,
  #modalClose:focus {
    color: var(--neon-2);
    outline: none;
  }

  /* === MODAL IMAGE AREA === */
  /* modal content is column flex with header / image area / buttons / footer */
  #modalContent { /* ensure a single definition that sets layout */
    display: flex;
    flex-direction: column;
    max-height: 90vh;
  }

  #modalImageWrapper {
    flex: 1 1 auto;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1rem;
    position: relative;
    overflow: auto; /* lets big images/models scroll inside modal */
    height: 500px;
  }
  #modalImageWrapper img {
    max-width: 100%;
    max-height: 100%;
    border-radius: 10px;
    user-select: none;
    pointer-events: none;
    object-fit: contain;
  }
  /* model-viewer full size */
  model-viewer#modalModelViewer {
    width: 100%;
    height: 100%;
    border-radius: 10px;
    background-color: #04122a;
    display: none; /* toggled via JS */
  }

  /* === MODAL BUTTONS === */
  #modalButtons {
    flex-shrink: 0;
    display: flex;
    gap: 0.7rem;
    flex-wrap: nowrap;
    justify-content: flex-start;
    padding: 0.75rem 1.25rem;
    overflow-x: auto; /* horizontal scroll if too many buttons */
    align-items: center;
    border-top: 1px solid rgba(255,255,255,0.03);
    background: linear-gradient(180deg, rgba(0,0,0,0.02), transparent);
  }
  #modalButtons button,
  #modalButtons a.button-like {
    background: transparent;
    border: 1.5px solid var(--neon-1);
    color: var(--neon-1);
    padding: 0.45rem 1rem;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    user-select: none;
    transition: background 0.3s, color 0.3s;
    white-space: nowrap;
  }
  #modalButtons button:hover,
  #modalButtons button.active,
  #modalButtons button:focus,
  #modalButtons a.button-like:hover {
    background: var(--neon-1);
    color: var(--bg-2);
    outline: none;
  }

  /* === MODAL FOOTER (git link or extra controls) === */
  #modalFooterButtons {
    flex-shrink: 0;
    display: flex;
    justify-content: flex-end;
    gap: 0.7rem;
    padding: 0.8rem 1.2rem;
    border-top: 1.5px solid var(--neon-1);
    background: var(--bg-2);
  }
  #modalFooterButtons a,
  #modalFooterButtons button {
    background: transparent;
    border: 1.5px solid var(--neon-1);
    color: var(--neon-1);
    padding: 0.5rem 1.2rem;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    text-align: center;
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
    user-select: none;
    transition: background 0.3s, color 0.3s;
    text-decoration: none;
  }
  #modalFooterButtons a:hover,
  #modalFooterButtons button:hover,
  #modalFooterButtons a:focus,
  #modalFooterButtons button:focus {
    background: var(--neon-1);
    color: var(--bg-2);
    outline: none;
  }

  /* small screens */
  @media (max-width: 900px) {
.page-toggle {
    width: 90%;             /* container takes most of screen */
    left: 50%;
    transform: translateX(-50%);
    display: flex;          /* keep side by side */
  }

  .page-toggle .toggle-btn {
    flex: 1 1 0;            /* make all buttons equal width */
    text-align: center;
    padding: 0.6rem 0;      /* reduce horizontal padding, width is now flex-based */
    font-size: 1rem;
  }
    nav.tabs {
      display: none;
    }
    .hamburger {
      display: flex;
    }
    main {
      margin: 6rem 1rem 2rem;
      padding: 1.25rem;
    }
    #modalContent {
      max-width: 100%;
      border-radius: 8px;
    }
  }
</style>
</head>
<body>

<nav class="tabs" aria-label="Main navigation">
  <a href="index.html">Home</a>
  <a href="skills.html">Skills</a>
  <a href="experience.html">Experience</a>
  <a href="projects.html">Projects</a>
  <a href="about.html">About</a>
  <a href="resume.html">Resume</a>
  <a href="courses.html">Courses</a>
  <a href="contact.html">Contact</a>
</nav>

<div class="hamburger" aria-label="Open navigation menu" role="button" tabindex="0" aria-expanded="false" aria-controls="mobile-menu">
  <span></span><span></span><span></span>
</div>

<nav id="mobile-menu" class="sidebar" aria-label="Mobile navigation" hidden>
  <a href="index.html">Home</a>
  <a href="skills.html">Skills</a>
  <a href="experience.html">Experience</a>
  <a href="projects.html">Projects</a>
  <a href="about.html">About</a>
  <a href="resume.html">Resume</a>
  <a href="courses.html">Courses</a>
  <a href="contact.html">Contact</a>
</nav>

<main>
  <h1>PCB Projects</h1>

  <div class="page-toggle">
    <a href="projects.html" class="toggle-btn">Hardware & Software</a>
    <a href="pcbs.html" class="toggle-btn active">PCB Gallery</a>
  </div>

  <div class="card-grid" id="pcbGrid" aria-label="List of PCB projects">
    <!-- PCB cards inserted dynamically -->
  </div>
</main>

<!-- MODAL -->
<div id="modalOverlay" aria-modal="true" role="dialog" aria-labelledby="modalTitle" tabindex="-1">
  <div id="modalContent" role="document" tabindex="0">
    <header id="modalHeader">
      <h2 id="modalTitle">PCB Title</h2>
      <button id="modalClose" aria-label="Close modal">&times;</button>
    </header>

    <!-- image / model area -->
    <div id="modalImageWrapper" aria-live="polite">
      <img src="" alt="PCB image view" id="modalImage" />
      <model-viewer id="modalModelViewer"
                    alt="3D model view"
                    camera-controls
                    auto-rotate
                    background-color="#00000000"
                    ar
                    ar-modes="webxr scene-viewer quick-look">
      </model-viewer>
    </div>

    <!-- All image-view buttons live here (Top/Bottom/Schem/2D Routing + VIEW 3D btn created dynamically) -->
    <div id="modalButtons" role="group" aria-label="Image view buttons">
      <!-- Buttons inserted dynamically -->
    </div>

    <!-- Footer reserved for "GitHub" or other external controls -->
    <div id="modalFooterButtons">
      <a href="#" target="_blank" id="btnGithub" rel="noopener noreferrer" aria-label="View on GitHub">GitHub</a>
    </div>
  </div>
</div>

<footer style="text-align:center;padding:1.5rem 0;color:var(--muted);font-size:0.85rem;">
  &copy; Sam — ECE @ UofT
</footer>

<script>
  // Hamburger toggle
  const hamburger = document.querySelector('.hamburger');
  const sidebar = document.getElementById('mobile-menu');

  function toggleMenu(){
    const isOpen = sidebar.classList.toggle('show');
    if(isOpen) sidebar.removeAttribute('hidden'); else sidebar.setAttribute('hidden','');
    hamburger.setAttribute('aria-expanded', isOpen);
  }
  hamburger.addEventListener('click', toggleMenu);
  hamburger.addEventListener('keydown', (e) => {
    if(e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      toggleMenu();
    }
  });
  sidebar.querySelectorAll('a').forEach(a => a.addEventListener('click', () => {
    sidebar.classList.remove('show'); sidebar.setAttribute('hidden',''); hamburger.setAttribute('aria-expanded', false);
  }));

  // PCB data sample with images (your paths kept)
  const pcbProjects = [
  {
      id: 1,
      title: "ESP32 Dev Board",
      description: "Custom ESP32 Dev Board",
      images: {
        top: "assets/esp32 3d.png",
        bottom: "assets/esp32 bottom.png",
        schematic: "assets/esp32_schem.png",
        routing2d: "assets/esp32_routing.png"
      },
      view3d: "assets/ESP32 with USBC PCB V1I1.glb",
      //github: "https://github.com/example/pcb-gamma"
    },  
  
  {
      id: 2,
      title: "LED Chaser",
      description: "An LED Chaser PCB",
      images: {
        top: "assets/LED Chaser Top.png",
        bottom: "assets/LED Chaser Bottom.png",
        routing2d: "assets/LED Chaser Routing.png",
        schematic: "assets/LED Chaser Schematic.png",
      },
      view3d: "assets/LED_Chaser.glb",
      //github: "https://github.com/example/pcb-alpha"
    },
    {
      id: 3,
      title: "Power Converter",
      description: "5V to 3.3V Step Down",
      images: {
        top: "assets/StepDown Top.png",
        bottom: "assets/StepDown Bottom.png",
        routing2d: "assets/StepDown Routing.png",
        schematic: "assets/StepDown Schematic.png"
      },
      view3d: "assets/PowerConverter.glb",
      //github: "https://github.com/example/pcb-beta"
    }
    
    
  ];

  const pcbGrid = document.getElementById('pcbGrid');
  const modalOverlay = document.getElementById('modalOverlay');
  const modalContent = document.getElementById('modalContent');
  const modalTitle = document.getElementById('modalTitle');
  const modalImage = document.getElementById('modalImage');
  const modalButtons = document.getElementById('modalButtons');
  const modalCloseBtn = document.getElementById('modalClose');
  const btnGithub = document.getElementById('btnGithub');
  const modalModelViewer = document.getElementById('modalModelViewer');

  let currentImageKey = 'top';
  let lastFocusedElement = null;

  // Create PCB cards on page
  function createPcbCards() {
    pcbProjects.forEach(pcb => {
      const card = document.createElement('article');
      card.className = 'pcb-card';
      card.setAttribute('tabindex', '0');
      card.setAttribute('role', 'button');
      card.setAttribute('aria-pressed', 'false');
      card.setAttribute('aria-label', `View details of ${pcb.title}`);

      const h3 = document.createElement('h3');
      h3.textContent = pcb.title;

      const p = document.createElement('p');
      p.textContent = pcb.description;

      const img = document.createElement('img');
      img.src = pcb.images.top || '';
      img.alt = pcb.title + ' PCB top view';

      card.appendChild(h3);
      card.appendChild(p);
      card.appendChild(img);

      // Open modal on click or Enter/Space key
      card.addEventListener('click', () => openModal(pcb));
      card.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          openModal(pcb);
        }
      });

      pcbGrid.appendChild(card);
    });
  }

  function updateActiveButton(activeKey) {
    const buttons = modalButtons.querySelectorAll('button');
    buttons.forEach(btn => {
      if (btn.getAttribute('data-key') === activeKey) {
        btn.classList.add('active');
        btn.setAttribute('aria-pressed', 'true');
      } else {
        btn.classList.remove('active');
        btn.setAttribute('aria-pressed', 'false');
      }
    });
  }

  function showImageView(src, alt) {
    // show image and hide model
    modalModelViewer.style.display = 'none';
    modalModelViewer.src = '';
    modalImage.style.display = 'block';
    modalImage.src = src;
    modalImage.alt = alt;
    // scroll image into view smoothly so user sees it
    requestAnimationFrame(() => {
      modalImage.scrollIntoView({behavior: 'smooth', block: 'center'});
    });
  }

  // toggle 3D viewer on/off (when using the inline View 3D button)
  function show3DView(src) {
    modalImage.style.display = 'none';
    modalModelViewer.src = src;
    modalModelViewer.style.display = 'block';
    // ensure model-viewer gets focus for accessibility/navigation
    setTimeout(() => {
      modalModelViewer.focus?.();
    }, 200);
    // scroll model into view
    requestAnimationFrame(() => {
      modalModelViewer.scrollIntoView({behavior: 'smooth', block: 'center'});
    });
  }

  function openModal(pcb) {
    lastFocusedElement = document.activeElement;

    modalTitle.textContent = pcb.title;
    currentImageKey = 'top';

    // Show initial top image view or fallback to first image key
    if (pcb.images.top) {
      showImageView(pcb.images.top, pcb.title + " top view");
      currentImageKey = 'top';
    } else {
      const firstKey = Object.keys(pcb.images)[0];
      showImageView(pcb.images[firstKey], pcb.title + ` ${firstKey} view`);
      currentImageKey = firstKey;
    }

    // Clear buttons container
    modalButtons.innerHTML = '';

    // Create image view buttons for all images in pcb.images
    Object.entries(pcb.images).forEach(([key, url]) => {
      const btn = document.createElement('button');
      btn.textContent = (key === 'routing2d') ? '2D Routing' : key.charAt(0).toUpperCase() + key.slice(1);
      btn.setAttribute('data-key', key);
      btn.setAttribute('type', 'button');

      if (key === currentImageKey) btn.classList.add('active');

      btn.addEventListener('click', () => {
        if (currentImageKey === key && modalImage.style.display === 'block') return; // no change
        currentImageKey = key;
        showImageView(pcb.images[key], `${pcb.title} ${btn.textContent} view`);
        updateActiveButton(key);
      });

      modalButtons.appendChild(btn);
    });

    // If there is a 3D model, create an inline View 3D button inside modalButtons (so it lines up)
    if (pcb.view3d) {
      const view3dBtn = document.createElement('button');
      view3dBtn.textContent = 'View 3D';
      view3dBtn.setAttribute('data-key', 'view3d');
      view3dBtn.setAttribute('type', 'button');

      let viewing3D = false;
      view3dBtn.addEventListener('click', () => {
        if (!viewing3D) {
          // Switch to 3D
          viewing3D = true;
          view3dBtn.classList.add('active');
          updateActiveButton(null); // clear other highlights
          show3DView(pcb.view3d);
          view3dBtn.textContent = 'View 2D';
        } else {
          // back to 2D: show currentImageKey or first image
          viewing3D = false;
          view3dBtn.classList.remove('active');
          view3dBtn.textContent = 'View 3D';
          if (pcb.images[currentImageKey]) {
            showImageView(pcb.images[currentImageKey], `${pcb.title} view`);
            updateActiveButton(currentImageKey);
          } else {
            // fallback to first image
            const firstKey = Object.keys(pcb.images)[0];
            currentImageKey = firstKey;
            showImageView(pcb.images[firstKey], `${pcb.title} ${firstKey} view`);
            updateActiveButton(firstKey);
          }
        }
      });

      // append after image buttons (so the order is Top Bottom Schem ... View 3D)
      modalButtons.appendChild(view3dBtn);
    }

    // Setup GitHub link button (in footer)
    if (pcb.github) {
      btnGithub.href = pcb.github;
      btnGithub.style.display = 'inline-flex';
    } else {
      btnGithub.style.display = 'none';
    }

    // Show modal and trap scrolling on body
    modalOverlay.classList.add('show');
    document.body.style.overflow = 'hidden'; // prevent background scroll while modal open
    // focus modal for screen readers / keyboard usage
    modalContent.focus();
    trapFocus(modalContent);
  }

  modalCloseBtn.addEventListener('click', closeModal);
  modalOverlay.addEventListener('click', e => {
    if (e.target === modalOverlay) {
      closeModal();
    }
  });
  document.addEventListener('keydown', e => {
    if (e.key === 'Escape' && modalOverlay.classList.contains('show')) {
      closeModal();
    }
  });

  function closeModal() {
    modalOverlay.classList.remove('show');
    modalModelViewer.style.display = 'none';
    modalModelViewer.removeAttribute('src');
    modalImage.style.display = 'block';
    modalImage.src = '';
    document.body.style.overflow = ''; // restore background scrolling
    // return focus to last focused element if available
    try { lastFocusedElement?.focus(); } catch (err) {}
  }

  // Trap focus inside modal for accessibility
  function trapFocus(element) {
    // Remove any previous handler to avoid duplicates
    element.removeEventListener('keydown', element._trapHandler);
    const focusableElements = element.querySelectorAll(
      'a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])'
    );
    if (focusableElements.length === 0) return;

    const firstEl = focusableElements[0];
    const lastEl = focusableElements[focusableElements.length - 1];

    element._trapHandler = function trap(e) {
      if (e.key === 'Tab') {
        if (e.shiftKey) {
          if (document.activeElement === firstEl) {
            e.preventDefault();
            lastEl.focus();
          }
        } else {
          if (document.activeElement === lastEl) {
            e.preventDefault();
            firstEl.focus();
          }
        }
      }
      if (e.key === 'Escape') {
        closeModal();
      }
    };

    element.addEventListener('keydown', element._trapHandler);
  }

  // Build the page
  createPcbCards();

modalModelViewer.addEventListener('error', (event) => {
  console.error('Model Viewer error:', event);
});

</script>

</body>
</html>




